import Fynx from 'fynx'
import {postLogout} from './services'
import Store, {MessageTypes} from '../shared/store'

export const logout = Fynx.createAsyncAction();

export const logoutComplete = Fynx.createAsyncAction();

// contact server
logout.listen(() => postLogout().then(logoutComplete));

// success
logoutComplete.listen(() => {
  Store.handleMessage({
    type: MessageTypes.Delete,
    payload: {
      table: 'user',
      row: user
    }
  });
});

// failure
loginFailure.listen(reason => alert(`Unable to login: ${reason}`));
